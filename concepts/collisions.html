
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Collisions &#8212; Newton Physics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b2b65678" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=938c9ccc"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'concepts/collisions';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="newton" href="../api/newton.html" />
    <link rel="prev" title="Custom Attributes" href="custom_attributes.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/newton-logo-light.png" class="logo__image only-light" alt="Newton Physics Logo"/>
    <img src="../_static/newton-logo-dark.png" class="logo__image only-dark pst-js-only" alt="Newton Physics Logo"/>
  
  
    <p class="title logo__title">Newton Physics <span style='font-size: 0.8em; color: #888;'>(0.2.0)</span></p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/visualization.html">
    Visualization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/key-concepts.html">
    Key Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/tutorials.html">
    Tutorials
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../guide/development.html">
    Development
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="articulations.html">
    Articulations
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="sites.html">
    Sites
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="sensors.html">
    Sensors
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="conventions.html">
    Conventions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="usd_parsing.html">
    USD Parsing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="custom_attributes.html">
    Custom Attributes
  </a>
</li>


<li class=" current active">
  <a class="nav-link dropdown-item nav-internal" href="#">
    Collisions and Contacts
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton.html">
    newton
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_geometry.html">
    newton.geometry
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_ik.html">
    newton.ik
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_selection.html">
    newton.selection
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_sensors.html">
    newton.sensors
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_solvers.html">
    newton.solvers
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_usd.html">
    newton.usd
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_utils.html">
    newton.utils
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/newton_viewer.html">
    newton.viewer
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../migration.html">
    Migration Guide
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../integrations/index.html">
    Integrations
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/newton-physics/newton">
     GitHub
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/visualization.html">
    Visualization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/key-concepts.html">
    Key Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/development.html">
    Development
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="articulations.html">
    Articulations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="sites.html">
    Sites
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="sensors.html">
    Sensors
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="conventions.html">
    Conventions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="usd_parsing.html">
    USD Parsing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="custom_attributes.html">
    Custom Attributes
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Collisions and Contacts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton.html">
    newton
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_geometry.html">
    newton.geometry
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_ik.html">
    newton.ik
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_selection.html">
    newton.selection
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_sensors.html">
    newton.sensors
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_solvers.html">
    newton.solvers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_usd.html">
    newton.usd
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_utils.html">
    newton.utils
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/newton_viewer.html">
    newton.viewer
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../faq.html">
    FAQ
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../migration.html">
    Migration Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../integrations/index.html">
    Integrations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/newton-physics/newton">
     GitHub
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/key-concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/development.html">Development</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="articulations.html">Articulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="sites.html">Sites</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensors.html">Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="usd_parsing.html">USD Parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_attributes.html">Custom Attributes</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Collisions and Contacts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../api/newton.html">newton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_geometry.html">newton.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_ik.html">newton.ik</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_selection.html">newton.selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_sensors.html">newton.sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_solvers.html">newton.solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_usd.html">newton.usd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_utils.html">newton.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/newton_viewer.html">newton.viewer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Further Reading</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations/index.html">Integrations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Project Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://github.com/newton-physics/newton"> GitHub</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Collisions</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="collisions">
<span id="id1"></span><h1>Collisions<a class="headerlink" href="#collisions" title="Link to this heading">#</a></h1>
<p>Newton provides a flexible collision detection system that supports both rigid-rigid and soft-rigid contacts. The collision pipeline handles broad phase culling, narrow phase contact generation, and filtering based on world indices and collision groups.</p>
<section id="collision-pipeline">
<span id="id2"></span><h2>Collision Pipeline<a class="headerlink" href="#collision-pipeline" title="Link to this heading">#</a></h2>
<p>The collision pipeline is responsible for detecting overlapping geometry and generating contact points between shapes. Newton provides two pipeline implementations with different trade-offs:</p>
<dl>
<dt><strong>CollisionPipeline</strong></dt><dd><p>The original implementation that uses precomputed shape pairs for collision detection.
Shape pairs are determined during model finalization based on filtering rules.
This pipeline is simple and efficient when the set of potentially colliding pairs is static.</p>
</dd>
<dt><strong>CollisionPipelineUnified</strong></dt><dd><p>An alternative implementation that supports multiple broad phase algorithms:</p>
<ul class="simple">
<li><p><strong>NxN</strong>: All-pairs AABB broad phase (O(N²), optimal for small scenes &lt;100 shapes)</p></li>
<li><p><strong>SAP</strong>: Sweep-and-prune AABB broad phase (O(N log N), better for larger scenes)</p></li>
<li><p><strong>EXPLICIT</strong>: Uses precomputed shape pairs (most efficient when pairs are known in advance)</p></li>
</ul>
<p>The unified pipeline is more flexible and performs better in scenes with dynamic topology or many shapes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CollisionPipelineUnified is currently work in progress and does not yet support all contact types
(e.g., some soft-rigid contact scenarios). Use the default CollisionPipeline if you encounter compatibility issues.</p>
</div>
</dd>
</dl>
<p>To use a collision pipeline, create it from your model and pass it to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.collide()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create unified pipeline with NxN broad phase (default)</span>
<span class="n">collision_pipeline</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">CollisionPipelineUnified</span><span class="o">.</span><span class="n">from_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">rigid_contact_max_per_pair</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">broad_phase_mode</span><span class="o">=</span><span class="n">newton</span><span class="o">.</span><span class="n">BroadPhaseMode</span><span class="o">.</span><span class="n">NXN</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Use the pipeline for collision detection</span>
<span class="n">contacts</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">collision_pipeline</span><span class="o">=</span><span class="n">collision_pipeline</span><span class="p">)</span>
</pre></div>
</div>
<p>If no collision pipeline is provided, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.collide()</span></code> creates a default <code class="xref py py-class docutils literal notranslate"><span class="pre">CollisionPipeline</span></code> instance using precomputed pairs.</p>
</section>
<section id="world-indices">
<span id="world-ids"></span><h2>World Indices<a class="headerlink" href="#world-indices" title="Link to this heading">#</a></h2>
<p>World indices enable multi-world simulations where multiple independent simulation instances coexist without interacting. Each entity (particle, body, shape, joint, articulation) has an associated world index that controls collision filtering:</p>
<ul class="simple">
<li><p><strong>Index -1</strong>: Global entities shared across all worlds (e.g., ground plane, environmental obstacles)</p></li>
<li><p><strong>Index 0, 1, 2, …</strong>: World-specific entities that only interact within their world</p></li>
</ul>
<p>Collision rules based on world indices:</p>
<ol class="arabic simple">
<li><p>Entities from different worlds (except -1) <strong>do not collide</strong> with each other</p></li>
<li><p>Global entities (index -1) <strong>collide with all worlds</strong></p></li>
<li><p>Within the same world, collision groups determine fine-grained interactions</p></li>
</ol>
<p>World indices are automatically managed when using <code class="xref py py-meth docutils literal notranslate"><span class="pre">ModelBuilder.add_world()</span></code> to instantiate multiple copies of a scene:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">ModelBuilder</span><span class="p">()</span>

<span class="c1"># Create global ground plane (collides with all worlds)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_ground_plane</span><span class="p">()</span>

<span class="c1"># Create robot builder</span>
<span class="n">robot_builder</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">ModelBuilder</span><span class="p">()</span>
<span class="n">robot_body</span> <span class="o">=</span> <span class="n">robot_builder</span><span class="o">.</span><span class="n">add_link</span><span class="p">()</span>
<span class="n">robot_builder</span><span class="o">.</span><span class="n">add_shape_sphere</span><span class="p">(</span><span class="n">robot_body</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">joint</span> <span class="o">=</span> <span class="n">robot_builder</span><span class="o">.</span><span class="n">add_joint_free</span><span class="p">(</span><span class="n">robot_body</span><span class="p">)</span>
<span class="n">robot_builder</span><span class="o">.</span><span class="n">add_articulation</span><span class="p">([</span><span class="n">joint</span><span class="p">])</span>

<span class="c1"># Instantiate robots in separate worlds</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_world</span><span class="p">(</span><span class="n">robot_builder</span><span class="p">)</span>  <span class="c1"># Creates world 0</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_world</span><span class="p">(</span><span class="n">robot_builder</span><span class="p">)</span>  <span class="c1"># Creates world 1</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_world</span><span class="p">(</span><span class="n">robot_builder</span><span class="p">)</span>  <span class="c1"># Creates world 2</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<span class="c1"># Robots from different worlds won&#39;t collide with each other,</span>
<span class="c1"># but all robots will collide with the global ground plane</span>
</pre></div>
</div>
<p>World indices are stored in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.shape_world</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.particle_world</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.body_world</span></code>, etc.</p>
<p>For heterogeneous worlds (where each world has different contents), use the <code class="xref py py-meth docutils literal notranslate"><span class="pre">begin_world()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">end_world()</span></code> methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">ModelBuilder</span><span class="p">()</span>

<span class="c1"># Global ground plane (default world -1)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_ground_plane</span><span class="p">()</span>

<span class="c1"># World 0: Robot with arm</span>
<span class="n">builder</span><span class="o">.</span><span class="n">begin_world</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;robot_arm&quot;</span><span class="p">)</span>
<span class="n">arm_base</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_box</span><span class="p">(</span><span class="n">arm_base</span><span class="p">,</span> <span class="n">hx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># ... add more robot parts</span>
<span class="n">builder</span><span class="o">.</span><span class="n">end_world</span><span class="p">()</span>

<span class="c1"># World 1: Quadruped</span>
<span class="n">builder</span><span class="o">.</span><span class="n">begin_world</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="s2">&quot;quadruped&quot;</span><span class="p">)</span>
<span class="n">quad_body</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_sphere</span><span class="p">(</span><span class="n">quad_body</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># ... add legs and joints</span>
<span class="n">builder</span><span class="o">.</span><span class="n">end_world</span><span class="p">()</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Performance benefits</strong></p>
<p>Using different worlds significantly improves both collision detection and solver performance:</p>
<ul class="simple">
<li><p><strong>Collision detection</strong>: Shapes from different worlds are automatically filtered during broad phase,
reducing the number of candidate pairs that need to be checked. This results in substantial performance
gains when simulating many independent environments.</p></li>
<li><p><strong>Solver performance</strong>: Separating non-interacting entities into different worlds can improve solver
efficiency by reducing unnecessary constraint coupling between independent systems.</p></li>
</ul>
<p>For large-scale parallel simulations (e.g., reinforcement learning with thousands of environments),
using world indices is essential for maintaining good performance.</p>
</section>
<section id="collision-groups">
<span id="id3"></span><h2>Collision Groups<a class="headerlink" href="#collision-groups" title="Link to this heading">#</a></h2>
<p>Collision groups provide fine-grained control over which shapes collide within the same world. Each shape has a collision group ID (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Model.shape_collision_group</span></code>) that determines interaction rules:</p>
<ul class="simple">
<li><p><strong>Group 0</strong>: No collisions (disabled)</p></li>
<li><p><strong>Positive groups (1, 2, 3, …)</strong>: Exclusive groups that only collide with themselves and negative groups</p></li>
<li><p><strong>Negative groups (-1, -2, -3, …)</strong>: Universal groups that collide with everything except their negative counterpart</p></li>
</ul>
<p>Collision group rules:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Group A</p></th>
<th class="head"><p>Group B</p></th>
<th class="head"><p>Collision?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Any</p></td>
<td><p>❌ No</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>✅ Yes (same positive group)</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>2</p></td>
<td><p>❌ No (different positive groups)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>-1</p></td>
<td><p>✅ Yes (positive with negative)</p></td>
</tr>
<tr class="row-even"><td><p>-1</p></td>
<td><p>-1</p></td>
<td><p>❌ No (same negative group)</p></td>
</tr>
<tr class="row-odd"><td><p>-1</p></td>
<td><p>-2</p></td>
<td><p>✅ Yes (different negative groups)</p></td>
</tr>
</tbody>
</table>
</div>
<p>To assign collision groups, use the <code class="xref py py-class docutils literal notranslate"><span class="pre">ModelBuilder.ShapeConfig</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">ModelBuilder</span><span class="p">()</span>

<span class="c1"># Body 1: Collision group 1</span>
<span class="n">body1</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">cfg1</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_sphere</span><span class="p">(</span><span class="n">body1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg1</span><span class="p">)</span>

<span class="c1"># Body 2: Collision group 2 (won&#39;t collide with group 1)</span>
<span class="n">body2</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">cfg2</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_sphere</span><span class="p">(</span><span class="n">body2</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg2</span><span class="p">)</span>

<span class="c1"># Body 3: Collision group -1 (collides with groups 1 and 2)</span>
<span class="n">body3</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">cfg3</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_sphere</span><span class="p">(</span><span class="n">body3</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg3</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="filtering-rules">
<span id="id4"></span><h2>Filtering Rules<a class="headerlink" href="#filtering-rules" title="Link to this heading">#</a></h2>
<p>Collision filtering combines world indices and collision groups to determine if two shapes should generate contacts. The filtering logic is implemented in the kernel function <code class="xref py py-func docutils literal notranslate"><span class="pre">test_world_and_group_pair()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_world_and_group_pair</span><span class="p">(</span><span class="n">world_a</span><span class="p">,</span> <span class="n">world_b</span><span class="p">,</span> <span class="n">group_a</span><span class="p">,</span> <span class="n">group_b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if two entities should collide.</span>

<span class="sd">    Returns True if entities should collide, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Rule 1: Check world indices first</span>
    <span class="k">if</span> <span class="n">world_a</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">world_b</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">world_a</span> <span class="o">!=</span> <span class="n">world_b</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Different worlds don&#39;t collide</span>

    <span class="c1"># Rule 2: If same world or at least one is global (-1),</span>
    <span class="c1">#         check collision groups</span>
    <span class="k">if</span> <span class="n">group_a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">group_b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># Group 0 disables collisions</span>

    <span class="k">if</span> <span class="n">group_a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Positive group: collides with same group or negative groups</span>
        <span class="k">return</span> <span class="n">group_a</span> <span class="o">==</span> <span class="n">group_b</span> <span class="ow">or</span> <span class="n">group_b</span> <span class="o">&lt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">group_a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Negative group: collides with everything except itself</span>
        <span class="k">return</span> <span class="n">group_a</span> <span class="o">!=</span> <span class="n">group_b</span>

    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>The filtering happens during the broad phase, ensuring that only valid shape pairs proceed to narrow phase contact generation.</p>
</section>
<section id="common-patterns">
<span id="common-collision-patterns"></span><h2>Common Patterns<a class="headerlink" href="#common-patterns" title="Link to this heading">#</a></h2>
<p><strong>Self-collision within an articulation</strong></p>
<p>By default, shapes within the same articulation use <code class="docutils literal notranslate"><span class="pre">collision_filter_parent=True</span></code>, which prevents parent-child body collisions. To enable full self-collision:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span><span class="o">.</span><span class="n">add_shape_box</span><span class="p">(</span>
    <span class="n">body</span><span class="o">=</span><span class="n">body_id</span><span class="p">,</span>
    <span class="n">hx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">cfg</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span>
        <span class="n">collision_group</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Collide with everything</span>
        <span class="n">collision_filter_parent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Enable parent-child collision</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>When loading from USD or MJCF, use the <code class="docutils literal notranslate"><span class="pre">enable_self_collisions</span></code> flag:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span><span class="o">.</span><span class="n">add_usd</span><span class="p">(</span><span class="s2">&quot;robot.usda&quot;</span><span class="p">,</span> <span class="n">enable_self_collisions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_mjcf</span><span class="p">(</span><span class="s2">&quot;robot.xml&quot;</span><span class="p">,</span> <span class="n">enable_self_collisions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Separate robot instances</strong></p>
<p>Use world indices to prevent collision between robot copies while allowing each to interact with the environment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global environment</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_ground_plane</span><span class="p">()</span>
<span class="n">obstacles</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_box</span><span class="p">(</span><span class="n">obstacles</span><span class="p">,</span> <span class="n">hx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Robot instances in separate worlds</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_robots</span><span class="p">):</span>
    <span class="n">builder</span><span class="o">.</span><span class="n">add_world</span><span class="p">(</span><span class="n">robot_builder</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Layer-based collision</strong></p>
<p>Use positive collision groups to implement collision layers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Layer 1: Player objects (only collide with themselves)</span>
<span class="n">player_cfg</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Layer 2: Enemy objects (only collide with themselves)</span>
<span class="n">enemy_cfg</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Layer 3: Environment (collides with all layers)</span>
<span class="n">env_cfg</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Disabling specific shapes</strong></p>
<p>Set collision group to 0 to disable collision for specific shapes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visual-only shape with no collision</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_mesh</span><span class="p">(</span>
    <span class="n">body</span><span class="o">=</span><span class="n">body_id</span><span class="p">,</span>
    <span class="n">mesh</span><span class="o">=</span><span class="n">visual_mesh</span><span class="p">,</span>
    <span class="n">cfg</span><span class="o">=</span><span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">collision_group</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="contact-generation">
<span id="id5"></span><h2>Contact Generation<a class="headerlink" href="#contact-generation" title="Link to this heading">#</a></h2>
<p>After the broad phase identifies potentially colliding shape pairs, the narrow phase generates contact points with geometric details:</p>
<ul class="simple">
<li><p><strong>Contact point</strong> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.rigid_contact_point</span></code>): World-space position of contact</p></li>
<li><p><strong>Contact normal</strong> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.rigid_contact_normal</span></code>): Direction from shape A to shape B</p></li>
<li><p><strong>Contact depth</strong> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.rigid_contact_depth</span></code>): Penetration depth (negative for separation)</p></li>
<li><p><strong>Contact shape IDs</strong> (<code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.rigid_contact_shape0</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.rigid_contact_shape1</span></code>): Indices of colliding shapes</p></li>
</ul>
<p>The maximum number of contacts per shape pair is controlled by <code class="docutils literal notranslate"><span class="pre">rigid_contact_max_per_pair</span></code> (default: 10). Use <code class="xref py py-func docutils literal notranslate"><span class="pre">Model.collide()</span></code> to generate contacts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">contacts</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">collide</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="c1"># Access contact data</span>
<span class="n">num_contacts</span> <span class="o">=</span> <span class="n">contacts</span><span class="o">.</span><span class="n">rigid_contact_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Scalar count</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">contacts</span><span class="o">.</span><span class="n">rigid_contact_point</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[:</span><span class="n">num_contacts</span><span class="p">]</span>
<span class="n">normals</span> <span class="o">=</span> <span class="n">contacts</span><span class="o">.</span><span class="n">rigid_contact_normal</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[:</span><span class="n">num_contacts</span><span class="p">]</span>
<span class="n">depths</span> <span class="o">=</span> <span class="n">contacts</span><span class="o">.</span><span class="n">rigid_contact_depth</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[:</span><span class="n">num_contacts</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="additional-topics">
<h2>Additional Topics<a class="headerlink" href="#additional-topics" title="Link to this heading">#</a></h2>
<p><strong>Contact margins</strong></p>
<p>Contact margins expand AABBs during broad phase to detect contacts slightly before actual penetration, improving stability for implicit integrators.</p>
<p>Rigid contact margins are controlled per-shape via <code class="docutils literal notranslate"><span class="pre">ShapeConfig.contact_margin</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set margin for specific shape</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span><span class="n">contact_margin</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_box</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">body_id</span><span class="p">,</span> <span class="n">hx</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">)</span>

<span class="c1"># Or set default margin for all shapes</span>
<span class="n">builder</span><span class="o">.</span><span class="n">rigid_contact_margin</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Must be set before finalize()</span>
</pre></div>
</div>
<p>Soft contact margins are specified via the <code class="docutils literal notranslate"><span class="pre">soft_contact_margin</span></code> parameter in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.collide()</span></code>. Default: 0.01.</p>
<p><strong>Soft-rigid contacts</strong></p>
<p>Contacts between particles and shapes are generated separately via <code class="xref py py-attr docutils literal notranslate"><span class="pre">Contacts.soft_contact_*</span></code> arrays. Soft contact generation is automatically enabled when particles are present in the model.</p>
<p id="contact-material-properties"><strong>Contact material properties</strong></p>
<p>Shape contact material properties control how contacts are resolved by different solvers. Not all properties are used by all solvers:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 50.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Used by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_ke" title="newton.Model.shape_material_ke"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_ke</span></code></a></p></td>
<td><p>Contact elastic stiffness</p></td>
<td><p>SemiImplicit, Featherstone, MuJoCo</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_kd" title="newton.Model.shape_material_kd"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_kd</span></code></a></p></td>
<td><p>Contact damping coefficient</p></td>
<td><p>SemiImplicit, Featherstone, MuJoCo</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_kf" title="newton.Model.shape_material_kf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_kf</span></code></a></p></td>
<td><p>Contact friction damping coefficient</p></td>
<td><p>SemiImplicit, Featherstone</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_ka" title="newton.Model.shape_material_ka"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_ka</span></code></a></p></td>
<td><p>Contact adhesion distance</p></td>
<td><p>SemiImplicit, Featherstone</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_mu" title="newton.Model.shape_material_mu"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_mu</span></code></a></p></td>
<td><p>Coefficient of friction</p></td>
<td><p>all solvers</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_restitution" title="newton.Model.shape_material_restitution"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_restitution</span></code></a></p></td>
<td><p>Coefficient of restitution (bounciness).</p></td>
<td><p>XPBD</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_torsional_friction" title="newton.Model.shape_material_torsional_friction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_torsional_friction</span></code></a></p></td>
<td><p>Coefficient of torsional friction (resistance to spinning at contact point)</p></td>
<td><p>XPBD, MuJoCo</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_rolling_friction" title="newton.Model.shape_material_rolling_friction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_rolling_friction</span></code></a></p></td>
<td><p>Coefficient of rolling friction (resistance to rolling motion)</p></td>
<td><p>XPBD, MuJoCo</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/_generated/newton.Model.html#newton.Model.shape_material_k_hydro" title="newton.Model.shape_material_k_hydro"><code class="xref py py-attr docutils literal notranslate"><span class="pre">shape_material_k_hydro</span></code></a></p></td>
<td><p>Contact stiffness for hydroelastic collisions (requires <code class="docutils literal notranslate"><span class="pre">is_hydroelastic=True</span></code>)</p></td>
<td><p>SemiImplicit, Featherstone, MuJoCo</p></td>
</tr>
</tbody>
</table>
</div>
<p>For solvers SemiImplicit and Featherstone, contact forces are computed using the <code class="docutils literal notranslate"><span class="pre">ke</span></code>, <code class="docutils literal notranslate"><span class="pre">kd</span></code>, <code class="docutils literal notranslate"><span class="pre">kf</span></code>, and <code class="docutils literal notranslate"><span class="pre">ka</span></code> parameters.
For position-based solvers (XPBD), the <code class="docutils literal notranslate"><span class="pre">restitution</span></code> parameter controls velocity reflection at contacts. To take effect, enable restitution in solver constructor via <code class="docutils literal notranslate"><span class="pre">enable_restitution=True</span></code>.</p>
<p>The MuJoCo solver converts <code class="docutils literal notranslate"><span class="pre">ke</span></code> and <code class="docutils literal notranslate"><span class="pre">kd</span></code> to MuJoCo’s <code class="docutils literal notranslate"><span class="pre">solref</span></code> parameters (timeconst and dampratio) for its constraint-based contact model.</p>
<p id="hydroelastic-contacts"><strong>Hydroelastic contacts</strong></p>
<p>Hydroelastic contact modeling generates areas of contact between colliding shapes using SDF-based collision detection.</p>
<p>To enable hydroelastic contacts, set <code class="docutils literal notranslate"><span class="pre">is_hydroelastic=True</span></code> on shapes that should participate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">builder</span> <span class="o">=</span> <span class="n">newton</span><span class="o">.</span><span class="n">ModelBuilder</span><span class="p">()</span>

<span class="c1"># Create a body with hydroelastic collision enabled</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">add_body</span><span class="p">()</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">ShapeConfig</span><span class="p">(</span>
    <span class="n">is_hydroelastic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">sdf_max_resolution</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="c1"># Maximum dimension for SDF grid</span>
    <span class="n">k_hydro</span><span class="o">=</span><span class="mf">1.0e11</span><span class="p">,</span>  <span class="c1"># Contact stiffness</span>
<span class="p">)</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_shape_box</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">hx</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hy</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">hz</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>
</div>
<p>For hydroelastic contacts to be generated, <strong>both</strong> shapes in a colliding pair must have <code class="docutils literal notranslate"><span class="pre">is_hydroelastic=True</span></code>.
By default, <code class="docutils literal notranslate"><span class="pre">reduce_contacts=True</span></code> is used, which produces fast, discrete approximation of the contact surface.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Hydroelastic contacts require volumetric shapes. Planes, heightfields, and non-watertight meshes
(e.g., cloth, shells, open surfaces) are not supported. For planes and heightfields, the flag
is automatically set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">k_hydro</span></code> parameter controls contact stiffness and should be tuned to achieve the desired, area-dependent penetration behavior for your simulation. Note that <code class="docutils literal notranslate"><span class="pre">k_hydro</span></code> is a simulation parameter and should not be expected to correspond directly to physical material properties such as Young’s modulus.</p>
<p><strong>USD collision attributes</strong></p>
<p>Custom collision groups and world indices can be authored in USD using custom attributes:</p>
<div class="highlight-usda notranslate"><div class="highlight"><pre><span></span><span class="k k-Tokens">def</span><span class="w"> </span>Xform<span class="w"> </span><span class="s">&quot;Box&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="kt">prepend</span><span class="w"> </span><span class="na">apiSchemas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;PhysicsRigidBodyAPI&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PhysicsCollisionAPI&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k k-Token">custom</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="na">newton:collision_group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="k k-Token">custom</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="na">newton:world</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="custom_attributes.html"><span class="doc">Custom Attributes</span></a> and <a class="reference internal" href="usd_parsing.html"><span class="doc">USD Parsing and Schema Resolver System</span></a> for details on USD integration.</p>
<p><strong>Performance considerations</strong></p>
<ul class="simple">
<li><p>Use <strong>EXPLICIT</strong> broad phase when shape pairs are known and static</p></li>
<li><p>Use <strong>SAP</strong> broad phase for scenes with &gt;100 shapes and spatially coherent motion</p></li>
<li><p>Use <strong>NxN</strong> broad phase for small scenes or when shapes are uniformly distributed</p></li>
<li><p>Minimize global entities (world=-1) as they interact with all worlds</p></li>
<li><p>Use positive collision groups to reduce the number of candidate pairs</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collision-pipeline">Collision Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#world-indices">World Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collision-groups">Collision Groups</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-rules">Filtering Rules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-patterns">Common Patterns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contact-generation">Contact Generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-topics">Additional Topics</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, The Newton Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>